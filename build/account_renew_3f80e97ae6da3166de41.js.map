{"version":3,"sources":["webpack:///./helpers/have_error.js","webpack:///./less/renew.less?939c","webpack:///./pages_pc/account/renew.js","webpack:///./helpers/get_token.js"],"names":["err","Object","keys","some","key","module","exports","renew","form-item","_react","__webpack_require__","Renew","oldPwdTouched","newPwdTouched","repeatPwdTouched","doModify","_this$props$form$getF","_this","props","form","getFieldsValue","old_pwd","new_pwd","repeat_pwd","_get_token2","default","axios","post","then","res","catch","Component","_this2","this","getFieldDecorator","getFieldsError","isFieldTouched","getFieldError","getFieldValue","btnErr","_have_error2","oldPwdErr","newPwdErr","repeatPwdErr","newPwd","_react2","createElement","className","_multiple_class2","styles","_form2","Item","_input2","disabled","value","sessionStorage","getItem","help","validateStatus","rules","required","message","type","placeholder","validator","rule","cb","timer","setTimeout","RegExp","test","_button2","style","width","onClick","validateFields","create","_history","token","history","push"],"mappings":"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","file":"account_renew_3f80e97ae6da3166de41.js","sourcesContent":["let haveError = (err) => {\r\n\treturn Object.keys(err).some(key => err[key]);\r\n};\r\nexport default haveError;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"renew\":\"_3KohaZjLW6BBIQO6f7h8-D\",\"form-item\":\"_1c7RIz90kpmgLj38NEDrN4\"};","import React, { Component } from 'react';\r\nimport { Form, Input, Button } from 'antd';\r\nimport styles from '../../less/renew.less';\r\nimport multipleClass from '../../helpers/multiple_class';\r\nimport getToken from '../../helpers/get_token';\r\nimport haveError from '../../helpers/have_error';\r\nimport axios from 'axios';\r\nclass Renew extends Component{\r\n\toldPwdTouched = false;\r\n\tnewPwdTouched = false;\r\n\trepeatPwdTouched = false;\r\n\trender(){\r\n\t\tlet { form } = this.props;\r\n\t\tlet { getFieldDecorator, getFieldsError, isFieldTouched, getFieldError, getFieldValue } = form;\r\n\t\tlet btnErr = haveError(getFieldsError());\r\n\t\tif(isFieldTouched('old_pwd')){\r\n\t\t\tthis.oldPwdTouched = true;\r\n\t\t}\r\n\t\tif(isFieldTouched('new_pwd')){\r\n\t\t\tthis.newPwdTouched = true;\r\n\t\t}\r\n\t\tif(isFieldTouched('repeat_pwd')){\r\n\t\t\tthis.repeatPwdTouched = true;\r\n\t\t}\r\n\t\tlet oldPwdErr, newPwdErr, repeatPwdErr;\r\n\t\tif(this.oldPwdTouched){\r\n\t\t\toldPwdErr = getFieldError('old_pwd')\r\n\t\t}\r\n\t\tif(this.newPwdTouched){\r\n\t\t\tnewPwdErr =  getFieldError('new_pwd');\r\n\t\t}\r\n\t\tif(this.repeatPwdTouched){\r\n\t\t\trepeatPwdErr = getFieldError('repeat_pwd');\r\n\t\t}\r\n\t\tlet newPwd = getFieldValue('new_pwd');\r\n\t\treturn (\r\n\t\t\t<div className={multipleClass(styles, 'renew')}>\r\n\t\t\t\t<Form>\r\n\t\t\t\t\t<Form.Item className={multipleClass(styles, 'form-item')}>\r\n\t\t\t\t\t\t<Input disabled={true} value={sessionStorage.getItem('phone')}/>\r\n\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t<Form.Item\r\n\t\t\t\t\t\thelp={oldPwdErr ? oldPwdErr : ''}\r\n\t\t\t\t\t\tvalidateStatus={oldPwdErr ? 'error': 'success'}\r\n\t\t\t\t\t\tclassName={multipleClass(styles, 'form-item')}>{getFieldDecorator('old_pwd', {\r\n\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\tmessage: '请输入旧密码'\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t})(\r\n\t\t\t\t\t\t<Input type='password' placeholder='旧密码'/>\r\n\t\t\t\t\t)}</Form.Item>\r\n\t\t\t\t\t<Form.Item\r\n\t\t\t\t\t\thelp={newPwdErr ? newPwdErr: ''}\r\n\t\t\t\t\t\tvalidateStatus={newPwdErr ? 'error': 'success'}\r\n\t\t\t\t\t\tclassName={multipleClass(styles, 'form-item')}>{getFieldDecorator('new_pwd', {\r\n\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\tmessage: '请输入新密码'\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t})(\r\n\t\t\t\t\t\t<Input type='password' placeholder='新密码'/>\r\n\t\t\t\t\t)}</Form.Item>\r\n\t\t\t\t\t<Form.Item\r\n\t\t\t\t\t\thelp={repeatPwdErr ? repeatPwdErr : ''}\r\n\t\t\t\t\t\tvalidateStatus={repeatPwdErr ? 'error': 'success'}\r\n\t\t\t\t\t\tclassName={multipleClass(styles, 'form-item')}>{getFieldDecorator('repeat_pwd', {\r\n\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\tmessage: '请再次输入新密码'\r\n\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\tmessage: '两次输入不匹配',\r\n\t\t\t\t\t\t\tvalidator: (rule, value, cb) => {\r\n\t\t\t\t\t\t\t\tthis.timer = null;\r\n\t\t\t\t\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\tlet reg = new RegExp(`^${value}`);\r\n\t\t\t\t\t\t\t\t\t\tif(reg.test(newPwd)) {\r\n\t\t\t\t\t\t\t\t\t\t\tcb();\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\tcb(true);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t})(\r\n\t\t\t\t\t\t<Input type='password' placeholder='再次确认新密码'/>\r\n\t\t\t\t\t)}</Form.Item>\r\n\t\t\t\t\t<Form.Item className={multipleClass(styles, 'form-item')}>\r\n\t\t\t\t\t\t<Button disabled={btnErr} type='primary' style={{width: '100%'}} onClick={this.doModify}>修改密码</Button>\r\n\t\t\t\t\t</Form.Item>\r\n\t\t\t\t</Form>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\tcomponentDidMount(){\r\n\t\tthis.props.form.validateFields();\r\n\t}\r\n\tdoModify = () => {\r\n\t\tlet { old_pwd, new_pwd, repeat_pwd } = this.props.form.getFieldsValue();\r\n\t\tif(new_pwd !== repeat_pwd)return;\r\n\t\tlet token = getToken();\r\n\t\tif(token){\r\n\t\t\taxios.post('/api/v1/user/update',{\r\n\t\t\t\told_pwd,\r\n\t\t\t\tnew_pwd\r\n\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\r\n\t\t\t\t})\r\n\t\t\t\t.catch(res => {\r\n\r\n\t\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\nexport default Form.create()(Renew);","import history from '../history';\r\nlet getToken = () => {\r\n\tlet token = sessionStorage.getItem('token');\r\n\tif(!token){\r\n\t\thistory.push('/login');\r\n\t\treturn false;\r\n\t}\r\n\treturn token;\r\n};\r\nexport default getToken"],"sourceRoot":""}