{"version":3,"sources":["webpack:///./stores/bank_bind.js","webpack:///./pages_pc/bank/bind.js","webpack:///./config/CONSTANT.js","webpack:///./helpers/get_token.js"],"names":["_mobx","__webpack_require__","Store","observable","_react","_CONSTANT","_mobxReact","Search","_input2","default","BankBind","observer","props","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","page","getUserList","arguments","length","undefined","token","_get_token2","axios","get","params","size","SIZE","key","store","headers","then","res","resData","data","user_list","total","catch","_message3","error","msg","handlePressEnter","val","bindAdmin","openid","record","name","id","match","post","bank_id","error_code","errorCode","history","push","columns","title","dataIndex","render","url","_react2","createElement","_avatar2","src","shape","style","margin","tex","bind","bindItem","Array","from","user_name","width","placeholder","onChange","e","target","value","onClick","Component","_this2","dataSource","current","Fragment","paddingBottom","textAlign","onSearch","_table2","rowKey","pagination","pageSize","MALE","FEMALE","_history","sessionStorage","getItem"],"mappings":"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","file":"scripts/12_ae53d6d2578ac12c80c5.js","sourcesContent":["import { observable } from 'mobx';\r\nclass Store {\r\n\t@observable user_list = [];\r\n\t@observable key = '';\r\n\t@observable total = 0;\r\n}\r\nexport default new Store();","import React, { Component } from 'react';\r\nimport { Button, Table, Input, Avatar, message } from 'antd';\r\nconst Search = Input.Search;\r\nimport axios from 'axios';\r\nimport getToken from '../../helpers/get_token';\r\nimport { SIZE } from '../../config/CONSTANT';\r\nimport store from '../../stores/bank_bind';\r\nimport { observer } from 'mobx-react';\r\n@observer\r\nclass BankBind extends Component{\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tstore.total = 0;\r\n\t}\r\n\tpage = 1;\r\n\trender(){\r\n\t\tlet total = store.total;\r\n\t\tlet dataSource = Array.from(store.user_list);\r\n\t\tlet current = this.page;\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<div style={{paddingBottom: '24px', textAlign: 'right'}}>\r\n\t\t\t\t\t<Search placeholder='请输入搜索关键字' onSearch={this.handlePressEnter} style={{width: 200}}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Table columns={this.columns} dataSource={dataSource} rowKey='id' pagination={total > SIZE ? {total,pageSize: SIZE,current, onChange: page => this.getUserList(page) } : false}/>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\tcomponentDidMount(){\r\n\t\tthis.getUserList();\r\n\t}\r\n\tgetUserList = (page = 1) => {\r\n\t\tlet token = getToken();\r\n\t\tthis.page = page;\r\n\t\tif(token){\r\n\t\t\taxios.get('/api/v1/users', {\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tpage,\r\n\t\t\t\t\tsize: SIZE,\r\n\t\t\t\t\tkey: store.key\r\n\t\t\t\t}\r\n\t\t\t}, {headers:{token}})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tlet resData = res.data;\r\n\t\t\t\t\tstore.user_list = resData.data;\r\n\t\t\t\t\tstore.total = resData.total;\r\n\t\t\t\t})\r\n\t\t\t\t.catch(res => {\r\n\t\t\t\t\tmessage.error(res.data.msg);\r\n\t\t\t\t})\r\n\t\t}\r\n\t};\r\n\thandlePressEnter = val => {\r\n\t\tstore.key = val;\r\n\t\tthis.getUserList();\r\n\t} ;\r\n\tbindAdmin = (openid, record) => {\r\n\t\tif(!record.name){\r\n\t\t\tmessage.error('请输入管理员真实姓名');\r\n\t\t\treturn ;\r\n\t\t}\r\n\t\tlet token = getToken();\r\n\t\tlet { match:{params:{id}}} = this.props;\r\n\t\tif(token){\r\n\t\t\taxios.post('/api/v1/bank/bind', {\r\n\t\t\t\tbank_id: id,\r\n\t\t\t\topenid: openid,\r\n\t\t\t\tname: record.name\r\n\t\t\t}, {headers:{token}})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tlet resData = res.data;\r\n\t\t\t\t\tif(resData.error_code === 0 || resData.errorCode === 0){\r\n\t\t\t\t\t\tthis.props.history.push('/bank/config');\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t}\r\n\t};\r\n\tcolumns = [{\r\n\t\ttitle: '头像',\r\n\t\tdataIndex: 'headimgurl',\r\n\t\tkey: 'headimgurl',\r\n\t\trender: url => <Avatar src={url} size='large' shape='square' style={{margin: '-50px 0'}}/>\r\n\t}, {\r\n\t\ttitle: '昵称',\r\n\t\tdataIndex: 'nickname'\r\n\t}, {\r\n\t\ttitle: '真实姓名',\r\n\t\trender: (tex, record) => {\r\n\t\t\tlet bind = record.bind || [];\r\n\t\t\tlet bindItem = Array.from(bind)[0] || {};\r\n\t\t\treturn !!bindItem.user_name ? bindItem.user_name : <Input style={{width: 150}} placeholder='管理员真实姓名' onChange={(e) => record.name = e.target.value}/>\r\n\r\n\t\t}\r\n\t},{\r\n\t\ttitle: '操作',\r\n\t\tdataIndex: 'openid',\r\n\t\tkey: 'openid',\r\n\t\trender: (openid, record) => !record.bind || !record.bind.length ? <a onClick={() => this.bindAdmin(openid, record)}>绑定</a> : null\r\n\t}]\r\n}\r\nexport default BankBind;","const SIZE = 15;\r\nconst MALE = 1,\r\n\tFEMALE = 2;\r\n\r\n// const\r\nexport {\r\n\tSIZE,\r\n\tMALE,\r\n\tFEMALE\r\n};","import history from '../history';\r\nlet getToken = () => {\r\n\tlet token = sessionStorage.getItem('token');\r\n\tif(!token){\r\n\t\thistory.push('/login');\r\n\t\treturn false;\r\n\t}\r\n\treturn token;\r\n};\r\nexport default getToken"],"sourceRoot":""}