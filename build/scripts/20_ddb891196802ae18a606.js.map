{"version":3,"sources":["webpack:///./stores/appointment_list.js","webpack:///./helpers/get_param.js","webpack:///./pages_mobile/appointment/list.js","webpack:///./config/CONSTANT.js","webpack:///./helpers/fresh_token.js","webpack:///./helpers/multiple_class.js","webpack:///./less/appointment_list.less?108f"],"names":["_mobx","__webpack_require__","_moment","Store","_moment2","default","this","date","format","observable","toDate","computed","search","location","href","split","paramsObj","forEach","p","paramArr","length","key","value","concat","_react","_mobxReact","_CONSTANT","_fresh_token","moment","locale","AppointmentList","observer","props","_classCallCheck","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","_initialiseProps","store","dataSource","_listView2","DataSource","rowHasChanged","row1","row2","appointment_list","param","_get_param2","day","Date","grade","state","data","decodeURIComponent","page","Component","_this2","visible","user_type","loading","_react2","createElement","className","_multiple_class2","styles","_button2","inline","size","onClick","goIndex","_list2","style","borderBottom","Item","openDateModal","_datePicker2","mode","onDismiss","closeDateModal","onOk","setDate","renderSectionHeader","renderRow","rowData","sectionID","rowID","_ref","btns","parseInt","type","reject","id","resolve","cancel","disabled","padding","display","_defineProperty","height","marginRight","src","headimgurl","alt","lineHeight","flexGrow","flexShrink","marginBottom","fontWeight","name","address","sex","MALE","service","service_item","money","renderSeparator","margin","renderFooter","textAlign","pageSize","useBodyScroll","onEndReached","loadMore","getAppointmentList","arguments","undefined","_this3","params","SIZE","axios","get","then","res","resData","appointmentList","Array","from","concatResult","user_grade","orders","total","cloneWithRows","catch","error_code","errorCode","getWxToken","_modal2","alert","text","onPress","handleAppointment","post","a","history","push","FEMALE","promise","wxToken","notForce","code","pathname","removeParams","requestURL","encodeURIComponent","Promise","window","host","indexOf","refreshWxToken","styleObj","classStr","trim","map","join","module","exports","home","btn-group"],"mappings":"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","file":"scripts/20_ddb891196802ae18a606.js","sourcesContent":["import { observable, computed } from 'mobx';\r\nimport moment from 'moment';\r\nclass Store {\r\n\t@observable date = moment().toDate();\r\n\t@observable grade;\r\n\t@observable visible = false;\r\n\t@observable appointment_list = [];\r\n\t@observable dataSource ;\r\n\t@observable user_type;\r\n\t@observable loading = false;\r\n\t@computed get day(){\r\n\t\treturn moment(this.date).format('YYYY-MM-DD');\r\n\t}\r\n}\r\nexport default new Store();","let getParam = () => {\r\n\tlet search = location.href.split('?')[1];\r\n\tif(search){\r\n\t\tsearch = search.split('#')[0];//去除hash的干扰\r\n\t\tlet paramsArr = search.split('&');\r\n\t\tlet paramsObj = {};\r\n\t\tparamsArr.forEach(p => {\r\n\t\t\tlet paramArr = p.split('=');\r\n\t\t\tif(paramArr.length === 2){\r\n\t\t\t\tlet key = paramArr[0];\r\n\t\t\t\tlet value = paramArr[1];\r\n\t\t\t\tif(paramsObj[key]){\r\n\t\t\t\t\tparamsObj[key] = [value].concat(paramsObj[key]);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tparamsObj[key] = value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn paramsObj;\r\n\t}\r\n\treturn {};\r\n};\r\nexport default getParam;","import React, { Component } from 'react';\r\nimport { Button, List, DatePicker, ListView, Modal } from 'antd-mobile';\r\nimport multipleClass from '../../helpers/multiple_class';\r\nimport styles from '../../less/appointment_list.less';\r\nimport { observer } from 'mobx-react';\r\nimport store from '../../stores/appointment_list';\r\nimport moment from 'moment';\r\nmoment.locale('zh_cn');\r\nimport axios from 'axios';\r\nimport { SIZE, MALE, FEMALE} from \"../../config/CONSTANT\";\r\nimport getParam from \"../../helpers/get_param\";\r\nimport { getWxToken } from \"../../helpers/fresh_token\";\r\n@observer\r\nclass AppointmentList extends Component{\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tstore.dataSource = new ListView.DataSource({\r\n\t\t\trowHasChanged: (row1, row2) => row1 !== row2,\r\n\t\t});\r\n\t\tstore.appointment_list = [];\r\n\t\tlet param = getParam();\r\n\t\tif(param.day){\r\n\t\t\tstore.date = new Date(param.day);\r\n\t\t}\r\n\t\tif(param.grade){\r\n\t\t\tstore.grade = param.grade;\r\n\t\t}else{\r\n\t\t\tstore.grade = '';\r\n\t\t}\r\n\t\tif(param.state){//根据下面定义的格式，取出数据\r\n\t\t\tlet state = decodeURIComponent(param.state);\r\n\t\t\tlet data = state.split('*');\r\n\t\t\tstore.date = new Date(data[0]);\r\n\t\t\tstore.grade = data[1];\r\n\t\t}\r\n\t\tthis.page = 1;\r\n\t}\r\n\trender(){\r\n\t\tlet { date, visible, dataSource, user_type, loading } = store;\r\n\t\tconst separator = (sectionID, rowID) => (\r\n\t\t\t<div\r\n\t\t\t\tkey={`${sectionID}-${rowID}`}\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tmargin: '0 15px',\r\n\t\t\t\t\tborderBottom: '1px solid #ECECED',\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t);\r\n\t\tconst row = (rowData, sectionID, rowID) => {\r\n\t\t\tlet btns = [];\r\n\t\t\tswitch (parseInt(rowData.state)){\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tif(user_type === 'admin'){\r\n\t\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t\t<Button inline={true} size='small' type='warning' onClick={() => this.reject(rowData.id)}>拒绝</Button>,\r\n\t\t\t\t\t\t\t<Button inline={true} size='small' type='primary' onClick={() => this.resolve(rowData.id)}>受理</Button>\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t\t<Button inline={true} size='small' type='warning' onClick={() => this.cancel(rowData.id)}>取消</Button>\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t<Button inline={true} size='small' type='primary' disabled={true}>已受理</Button>\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t<Button inline={true} size='small' type='warning' disabled={true}>已受理</Button>\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t<Button inline={true} size='small' type='ghost' disabled={true} >已取消</Button>\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<div key={rowID} style={{ padding: '0 15px' }}>\r\n\t\t\t\t\t<div style={{ display: '-webkit-box', display: 'flex', padding: '15px 0' }}>\r\n\t\t\t\t\t\t<img style={{ height: '64px', marginRight: '15px' }} src={rowData.headimgurl} alt=\"\" />\r\n\t\t\t\t\t\t<div style={{ lineHeight: 1, flexGrow: 1, flexShrink: 1 }}>\r\n\t\t\t\t\t\t\t<div style={{ marginBottom: '8px', fontWeight: 'bold' }}>{rowData.name}</div>\r\n\t\t\t\t\t\t\t<p>{rowData.address}, {rowData.sex === MALE ? '男' : '女'}</p>\r\n\t\t\t\t\t\t\t<p>{rowData.service + '/' +rowData.service_item}{rowData.money > 0 ? '/' + rowData.money : ''}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className={multipleClass(styles, 'btn-group')}>{btns}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t};\r\n\t\treturn (\r\n\t\t\t<div className='appointment_list'>\r\n\t\t\t\t<div className={multipleClass(styles, 'home')}>\r\n\t\t\t\t\t<Button inline={true} size='small' onClick={this.goIndex}>首页</Button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<List style={{borderBottom:'none'}}>\r\n\t\t\t\t\t<List.Item\r\n\t\t\t\t\t\tonClick={this.openDateModal}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span>预约日期</span>\r\n\t\t\t\t\t\t<span className={multipleClass(styles, 'date')}>{moment(date).format('YYYY/MM/DD dddd')}</span>\r\n\t\t\t\t\t</List.Item>\r\n\t\t\t\t</List>\r\n\t\t\t\t<DatePicker\r\n\t\t\t\t\tvisible={visible}\r\n\t\t\t\t\tmode='date'\r\n\t\t\t\t\tonDismiss={this.closeDateModal}\r\n\t\t\t\t\tonOk={this.setDate}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListView\r\n\t\t\t\t\tdataSource={dataSource}\r\n\t\t\t\t\trenderSectionHeader={() => <span>预约列表</span>}\r\n\t\t\t\t\trenderRow={row}\r\n\t\t\t\t\trenderSeparator={separator}\r\n\t\t\t\t\trenderFooter={() => (<div style={{ padding: 30, textAlign: 'center' }}>\r\n\t\t\t\t\t\t{loading ? 'Loading...' : 'Loaded'}\r\n\t\t\t\t\t</div>)}\r\n\t\t\t\t\tpageSize={4}\r\n\t\t\t\t\tuseBodyScroll\r\n\t\t\t\t\tonEndReached={this.loadMore}\r\n\t\t\t\t>\r\n\t\t\t\t</ListView>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\tcomponentDidMount(){\r\n\t\tthis.getAppointmentList(this.page);\r\n\t}\r\n\tgetAppointmentList = (page = 1) => {\r\n\t\tlet { day, grade } = store;\r\n\t\tif(page === 1){\r\n\t\t\tthis.page = 1;//初始化\r\n\t\t}\r\n\t\tlet params = {\r\n\t\t\tpage,\r\n\t\t\tsize: SIZE,\r\n\t\t\tday: day\r\n\t\t};\r\n\t\tif(grade){\r\n\t\t\tparams.grade = grade;\r\n\t\t}\r\n\t\taxios.get('/api/v1/orders/wx', {\r\n\t\t\tparams: params\r\n\t\t})\r\n\t\t\t.then(res => {\r\n\t\t\t\tstore.loading = false;\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tlet appointmentList = Array.from(store.appointment_list);\r\n\t\t\t\tif(page === 1){//第一页重新渲染\r\n\t\t\t\t\tappointmentList = [];\r\n\t\t\t\t}\r\n\t\t\t\tlet concatResult;\r\n\t\t\t\tif(resData.user_grade == 1){//用户\r\n\t\t\t\t\t//普通用户不需要分页。。。\r\n\t\t\t\t\tconcatResult = resData.orders;\r\n\t\t\t\t\tstore.user_type = 'user';\r\n\t\t\t\t}else{//管理员\r\n\t\t\t\t\tconcatResult = appointmentList.concat(resData.data);\r\n\t\t\t\t\tstore.total = resData.total;\r\n\t\t\t\t\tstore.user_type = 'admin';\r\n\t\t\t\t}\r\n\t\t\t\tstore.appointment_list = concatResult;\r\n\t\t\t\tstore.dataSource = store.dataSource.cloneWithRows(concatResult);\r\n\t\t\t})\r\n\t\t\t.catch(res => {\r\n\t\t\t\tstore.loading = false;\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tlet param = getParam();\r\n\t\t\t\tlet state = '';//在授权后依然能保留的数据\r\n\t\t\t\tif(param.day && param.grade){\r\n\t\t\t\t\tlet day = param.day.split(' ')[0];\r\n\t\t\t\t\tstate = day + '*' + param.grade;\r\n\t\t\t\t}else if(param.state){\r\n\t\t\t\t\tstate = param.state;\r\n\t\t\t\t}\r\n\t\t\t\tif (!resData) {\r\n\t\t\t\t\tlet promise = getWxToken(state);\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getAppointmentList();\r\n\t\t\t\t\t})\r\n\t\t\t\t} else if (resData.error_code === 10001 || resData.errorCode === 10001) {\r\n\t\t\t\t\tlet promise = getWxToken(state);\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getAppointmentList();\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t};\r\n\treject = (id) => {\r\n\t\tModal.alert('拒绝受理', '将拒绝受理此项业务，请确认',[\r\n\t\t\t{\r\n\t\t\t\ttext: '取消'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: '确认',\r\n\t\t\t\tonPress: () => this.handleAppointment(id, 3)\r\n\t\t\t}\r\n\t\t])\r\n\t};\r\n\tresolve = (id) => {\r\n\t\tModal.alert('受理', '将受理此项业务，请确认',[\r\n\t\t\t{\r\n\t\t\t\ttext: '取消'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: '确认',\r\n\t\t\t\tonPress: () => this.handleAppointment(id, 2)\r\n\t\t\t}\r\n\t\t])\r\n\t};\r\n\tcancel = id => {\r\n\t\tModal.alert('取消预约', '将取消预约此项业务，请确认',[\r\n\t\t\t{\r\n\t\t\t\ttext: '取消'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: '确认',\r\n\t\t\t\tonPress: () => this.handleAppointment(id, 4)\r\n\t\t\t}\r\n\t\t])\r\n\t};\r\n\tloadMore = () => {\r\n\t\tstore.loading = true;\r\n\t\tthis.getAppointmentList(++this.page);\r\n\t};\r\n\thandleAppointment = (id, state) => {\r\n\t\taxios.post('/api/v1/order/handel', {\r\n\t\t\tid: id,\r\n\t\t\tstate\r\n\t\t})\r\n\t\t\t.then(res => {\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tif(resData.error_code === 0 || resData.errorCode === 0){\r\n\t\t\t\t\tlet appointmentList = Array.from(store.appointment_list);\r\n\t\t\t\t\tappointmentList.forEach(a => {\r\n\t\t\t\t\t\tif(a.id === id){\r\n\t\t\t\t\t\t\ta.state = state;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tstore.appointment_list = appointmentList;\r\n\t\t\t\t\tstore.dataSource = store.dataSource.cloneWithRows(appointmentList);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(res => {\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tif (!resData) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\t//this.getUserLocation();\r\n\t\t\t\t\t})\r\n\t\t\t\t} else if (resData.error_code === 10001 || resData.errorCode === 10001) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\t//this.getUserLocation();\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t};\r\n\tgoIndex = () => {\r\n\t\tthis.props.history.push('/');\r\n\t};\r\n\topenDateModal = () => {\r\n\t\tstore.visible = true;\r\n\t};\r\n\tcloseDateModal = () => {\r\n\t\tstore.visible = false;\r\n\t};\r\n\tsetDate = (date) => {\r\n\t\tstore.date = date;\r\n\t\tstore.visible = false;\r\n\t\tthis.getAppointmentList();\r\n\t}\r\n}\r\nexport default AppointmentList;","const SIZE = 15;\r\nconst MALE = 1,\r\n\tFEMALE = 2;\r\n\r\n// const\r\nexport {\r\n\tSIZE,\r\n\tMALE,\r\n\tFEMALE\r\n};","import axios from 'axios';\r\nimport getParam from './get_param';\r\nimport history from '../history';\r\nlet promise = null;\r\n\r\nlet wxToken = (notForce, code, state) => {\r\n\tlet { location: {pathname} } = history;\r\n\tlet removeHash = location.href.split('#')[0];\r\n\tlet removeParams = removeHash.split('?')[0];\r\n\tlet origin = encodeURIComponent(removeParams + '#' + pathname);\r\n\tlet appid = 'wxf4b7d664b2461f4b';\r\n\tlet requestURL = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${appid}&redirect_uri=${origin}&response_type=code&scope=snsapi_userinfo&state=${state}#wechat_redirect`;\r\n\t//notForce true,上传code供后端获取用户信息 false,强制重新获取code\r\n\tif(!notForce){\r\n\t\twindow.location = requestURL;\r\n\t}else{\r\n\t\tif(promise) return promise;\r\n\t\tpromise = new Promise((resolve, reject) =>{\r\n\t\t\taxios.get('/api/v1/token/user', {\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tcode\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tpromise = null;\r\n\t\t\t\t\tresolve(res);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(res => {\r\n\t\t\t\t\tpromise = null;\r\n\t\t\t\t\treject(res);\r\n\t\t\t\t})\r\n\t\t});\r\n\t\treturn promise;\r\n\t}\r\n};\r\n\r\nlet getWxToken = (state = '') => {\r\n\t//如果有code则上传\r\n\tlet code = getParam().code;\r\n\t// alert(code);\r\n\tif(location.host.indexOf('localhost') !== -1 || location.host.indexOf('127.0.0.1') !== -1) return new Promise((resolve, reject) => {\r\n\t\treject();\r\n\t});\r\n\treturn wxToken(!!code, code, state);\r\n};\r\nlet refreshWxToken = () => {\r\n\t//强制重新获取code\r\n\treturn wxToken(false);\r\n};\r\nexport {\r\n\tgetWxToken,\r\n\trefreshWxToken\r\n};","let multipleClass = (styleObj, classStr) => {\r\n\treturn classStr.trim().split(/\\s+/).map(key => styleObj[key]).join(' ');\r\n};\r\nexport default multipleClass;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"home\":\"_2sfP_co4kRvgphaC1NMPV2\",\"date\":\"_3fLReK9Q-jcWfZk702_V5Z\",\"btn-group\":\"xgFttKZnF3OHJtqAx5OvH\"};"],"sourceRoot":""}