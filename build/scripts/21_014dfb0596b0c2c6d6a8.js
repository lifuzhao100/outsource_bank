(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{GZoT:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){var e=location.href.split("?")[1];if(e){var t={};return(e=e.split("#")[0]).split("&").forEach(function(e){var n=e.split("=");if(2===n.length){var i=n[0],r=decodeURIComponent(n[1]);t[i]?t[i]=[r].concat(t[i]):t[i]=r}}),t}return{}}},WVMr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r,a,o,u,l,c,f,s,d,p,m,h,y,v,b,_,g,k,w,M,x,O,D,z,E=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),j=n("cneo"),T=n("wy2R"),P=(z=T)&&z.__esModule?z:{default:z};function S(e,t,n,i){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function C(e,t,n,i,r){var a={};return Object.keys(i).forEach(function(e){a[e]=i[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,i){return i(e,t,n)||n},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var Y=(i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),S(this,"money_type_list",r,this),S(this,"selectSex",a,this),S(this,"bank_list",o,this),S(this,"selected_bank",u,this),S(this,"origin_service_type_list",l,this),S(this,"service_type_list",c,this),S(this,"service_type",f,this),S(this,"service_content_list",s,this),S(this,"service_content",d,this),S(this,"showMoney",p,this),S(this,"showMoneyType",m,this),S(this,"date",h,this),S(this,"time",y,this),S(this,"name",v,this),S(this,"inputPhone",b,this),S(this,"identity",_,this),S(this,"money",g,this),S(this,"remark",k,this),S(this,"name_sub",w,this),S(this,"time_begin",M,this),S(this,"time_end",x,this),S(this,"minMaxDate",O,this),S(this,"minMaxTime",D,this)}return E(e,[{key:"init",get:function(){return this.service_type.length>0&&-1!==this.service_type[0].indexOf("对公")?{type:"对公"}:{type:"个人"}}},{key:"phone",get:function(){return this.inputPhone&&this.inputPhone.split(" ").join("")}},{key:"sex",get:function(){return this.selectSex&&this.selectSex[0]}},{key:"bank_id",get:function(){return this.selected_bank&&this.selected_bank[0]}},{key:"service",get:function(){return this.service_type&&this.service_type[0]}},{key:"service_item",get:function(){return this.service_content&&this.service_content[0]}},{key:"day",get:function(){if(this.date&&this.time){var e=(0,P.default)(this.date).format("YYYY-MM-DD"),t=(0,P.default)(this.time).format("HH:mm");return(0,P.default)(e+" "+t,"YYYY-MM-DD HH:mm").format("YYYY-MM-DD HH:mm")}return null}},{key:"disableBtn",get:function(){return"对公"===this.init.type&&!this.name_sub||(!(!this.showMoneyType||Array.from(this.money_type_list).some(function(e){return!!e.checked}))||(!this.name||!this.phone||!this.identity||!this.sex||!this.bank_id||!this.service||!this.service_item||!this.day||this.showMoney&&!this.money))}}]),e}(),r=C(i.prototype,"money_type_list",[j.observable],{enumerable:!0,initializer:function(){return[{checked:!1,value:"5角"},{checked:!1,value:"1元"},{checked:!1,value:"5元"},{checked:!1,value:"10元"},{checked:!1,value:"20元"}]}}),a=C(i.prototype,"selectSex",[j.observable],{enumerable:!0,initializer:function(){return[]}}),o=C(i.prototype,"bank_list",[j.observable],{enumerable:!0,initializer:function(){return[]}}),u=C(i.prototype,"selected_bank",[j.observable],{enumerable:!0,initializer:function(){return[]}}),l=C(i.prototype,"origin_service_type_list",[j.observable],{enumerable:!0,initializer:function(){return[]}}),c=C(i.prototype,"service_type_list",[j.observable],{enumerable:!0,initializer:function(){return[]}}),f=C(i.prototype,"service_type",[j.observable],{enumerable:!0,initializer:function(){return[]}}),s=C(i.prototype,"service_content_list",[j.observable],{enumerable:!0,initializer:function(){return[]}}),d=C(i.prototype,"service_content",[j.observable],{enumerable:!0,initializer:function(){return[]}}),p=C(i.prototype,"showMoney",[j.observable],{enumerable:!0,initializer:function(){return!1}}),m=C(i.prototype,"showMoneyType",[j.observable],{enumerable:!0,initializer:function(){return!1}}),h=C(i.prototype,"date",[j.observable],{enumerable:!0,initializer:function(){return null}}),y=C(i.prototype,"time",[j.observable],{enumerable:!0,initializer:function(){return null}}),v=C(i.prototype,"name",[j.observable],{enumerable:!0,initializer:null}),b=C(i.prototype,"inputPhone",[j.observable],{enumerable:!0,initializer:null}),_=C(i.prototype,"identity",[j.observable],{enumerable:!0,initializer:null}),g=C(i.prototype,"money",[j.observable],{enumerable:!0,initializer:null}),k=C(i.prototype,"remark",[j.observable],{enumerable:!0,initializer:function(){return""}}),w=C(i.prototype,"name_sub",[j.observable],{enumerable:!0,initializer:null}),M=C(i.prototype,"time_begin",[j.observable],{enumerable:!0,initializer:function(){return(0,P.default)("08:00","mm:ss")}}),x=C(i.prototype,"time_end",[j.observable],{enumerable:!0,initializer:function(){return(0,P.default)("15:00","mm:ss")}}),O=C(i.prototype,"minMaxDate",[j.observable],{enumerable:!0,initializer:function(){return{}}}),D=C(i.prototype,"minMaxTime",[j.observable],{enumerable:!0,initializer:function(){return{}}}),C(i.prototype,"init",[j.computed],Object.getOwnPropertyDescriptor(i.prototype,"init"),i.prototype),C(i.prototype,"phone",[j.computed],Object.getOwnPropertyDescriptor(i.prototype,"phone"),i.prototype),C(i.prototype,"sex",[j.computed],Object.getOwnPropertyDescriptor(i.prototype,"sex"),i.prototype),C(i.prototype,"bank_id",[j.computed],Object.getOwnPropertyDescriptor(i.prototype,"bank_id"),i.prototype),C(i.prototype,"service",[j.computed],Object.getOwnPropertyDescriptor(i.prototype,"service"),i.prototype),C(i.prototype,"service_item",[j.computed],Object.getOwnPropertyDescriptor(i.prototype,"service_item"),i.prototype),C(i.prototype,"day",[j.computed],Object.getOwnPropertyDescriptor(i.prototype,"day"),i.prototype),C(i.prototype,"disableBtn",[j.computed],Object.getOwnPropertyDescriptor(i.prototype,"disableBtn"),i.prototype),i);t.default=new Y},aZFF:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMinMaxDate=t.getMinMaxTime=void 0;var i,r=n("wy2R"),a=(i=r)&&i.__esModule?i:{default:i};t.getMinMaxTime=function(e,t,n){var i=(0,a.default)(),r=i.format("YYYY-MM-DD"),o=(0,a.default)(e).format("YYYY-MM-DD"),u=void 0,l=void 0,c=t.hour(),f=t.minute(),s=n.hour(),d=n.minute();return o===r?i.hour()<8?(u=(0,a.default)().hour(c).minute(f),l=(0,a.default)().hour(s).minute(d)):u=(0,a.default)().minute()>30?(0,a.default)().add(1,"h").minute(0):(0,a.default)().minute(30):u=t,l=(0,a.default)().hour(s).minute(d),{minDate:u.toDate(),maxDate:l.toDate(),defaultDate:u.toDate()}},t.getMinMaxDate=function(e,t){var n=(0,a.default)(),i=void 0,r=void 0,o=0,u=t.hour(),l=t.minute(),c=e.hour(),f=e.minute();return n.hour()>u||n.hour()===u&&n.minute()>l?(o+=1,i=(0,a.default)().add(o,"d").hour(c).minute(f)):i=(0,a.default)().minute(0),r=(0,a.default)().add(o+2,"d").hour(u).minute(l),{minDate:i.toDate(),maxDate:r.toDate()}},t.default=function(){var e=(0,a.default)();return{minDate:(e.minute()>30?e.add(1,"h").minute(0):e.minute(30)).toDate(),maxDate:(0,a.default)().add(2,"d").hour(23).minute(59).toDate()}}},dO77:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refreshWxToken=t.getWxToken=void 0;var i=o(n("czhI")),r=o(n("GZoT")),a=o(n("SGp1"));function o(e){return e&&e.__esModule?e:{default:e}}var u=null,l=function(e,t,n){var r=a.default.location.pathname,o=location.href.split("#")[0].split("?")[0],l=encodeURIComponent(o+"#"+r),c="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+window.appConfig.appId+"&redirect_uri="+l+"&response_type=code&scope=snsapi_userinfo&state="+n+"#wechat_redirect";if(e)return u||(u=new Promise(function(e,n){i.default.get("/api/v1/token/user",{params:{code:t}}).then(function(t){u=null,e(t)}).catch(function(e){u=null,n(e)})}));window.location=c};t.getWxToken=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,r.default)().code;return-1!==location.host.indexOf("localhost")||-1!==location.host.indexOf("127.0.0.1")?new Promise(function(e,t){t()}):l(!!t,t,e)},t.refreshWxToken=function(){return l(!1)}},jgSJ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r,a,o=j(n("gyVw")),u=j(n("CGtu")),l=j(n("ZAQZ")),c=j(n("AnVD")),f=j(n("Biz3")),s=j(n("icwN")),d=j(n("OSZ1")),p=j(n("5da2")),m=j(n("sqhG")),h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},y=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();n("4Y1d"),n("AZLO"),n("p9mG"),n("FCEn"),n("j15+"),n("1bJb"),n("Xzgj"),n("Nt9i"),n("Wi5A");var v=n("mXGw"),b=j(v),_=j(n("qLGs")),g=j(n("nE73")),k=n("mBK0"),w=n("cneo"),M=j(n("WVMr")),x=n("aZFF"),O=j(n("czhI")),D=j(n("SGp1")),z=n("dO77"),E=j(n("wy2R"));function j(e){return e&&e.__esModule?e:{default:e}}var T=m.default.CheckboxItem,P=(0,k.observer)((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.call(n);var i=M.default.time_begin,r=M.default.time_end;return M.default.minMaxDate=(0,x.getMinMaxDate)(i,r),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,v.Component),y(t,[{key:"componentDidMount",value:function(){this.getServiceList(),this.getBankList(),this.autorunHandler=(0,w.autorun)(function(){var e=M.default.date,t=M.default.time_begin,n=M.default.time_end;if(e){var i=(0,x.getMinMaxTime)(e,t,n),r=i.defaultDate,a=function(e,t){var n={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}(i,["defaultDate"]);M.default.minMaxTime=a,M.default.time=r}})}},{key:"componentWillUnmount",value:function(){this.autorunHandler()}},{key:"render",value:function(){var e=this,t=M.default.showMoney,n=M.default.showMoneyType,i=M.default.date,r=M.default.time,a=M.default.bank_list,o=M.default.selected_bank,m=M.default.disableBtn,y=M.default.init,v=M.default.minMaxDate,k=M.default.minMaxTime,w=M.default.money_type_list,x=M.default.time_begin,O=M.default.time_end,D=Array.from(a),z=Array.from(o),E=Array.from(M.default.selectSex),j=Array.from(M.default.service_type_list),P=Array.from(M.default.service_type),S=Array.from(M.default.service_content_list),C=Array.from(M.default.service_content),Y=Array.from(w);return b.default.createElement("div",null,b.default.createElement("h3",{className:(0,g.default)(_.default,"header")},"填写预约信息"),b.default.createElement(p.default,null,b.default.createElement(d.default,{data:j,value:P,cols:1,onOk:this.pickServiceType},b.default.createElement(p.default.Item,{arrow:"horizontal"},"服务类别")),b.default.createElement(d.default,{data:S,value:C,cols:1,onOk:this.pickServiceContent},b.default.createElement(p.default.Item,{arrow:"horizontal"},"服务内容")),"对公"===y.type?b.default.createElement(b.default.Fragment,null,b.default.createElement(s.default,{placeholder:"请输入企业名称",onChange:function(e){return M.default.name=e}},"企业名称"),b.default.createElement(s.default,{placeholder:"请输入15位或18位的社会信用代码",onChange:function(e){return M.default.identity=e}},"营业执照号"),b.default.createElement(s.default,{placeholder:"请输入企业联系人姓名",onChange:function(e){return M.default.name_sub=e}},"联系人")):b.default.createElement(b.default.Fragment,null,b.default.createElement(s.default,{placeholder:"请输入姓名",onChange:function(e){return M.default.name=e}},"姓名"),b.default.createElement(s.default,{placeholder:"请输入身份证号",onChange:function(e){return M.default.identity=e}},"身份证号")),b.default.createElement(s.default,{placeholder:"请输入手机号",type:"phone",onChange:function(e){return M.default.inputPhone=e}},"手机号"),b.default.createElement(d.default,{data:this.sexList,value:E,cols:1,onOk:this.pickSex},b.default.createElement(p.default.Item,{arrow:"horizontal"},"性别")),b.default.createElement(d.default,{data:D,value:z,cols:1,onOk:this.pickBank},b.default.createElement(p.default.Item,{arrow:"horizontal"},"预约银行")),t?b.default.createElement(s.default,{placeholder:"请输入预约金额",type:"money",moneyKeyboardAlign:"left",onChange:function(e){return M.default.money=e}},"预约金额"):null,n?b.default.createElement(p.default,{className:"show_money_type"},b.default.createElement("div",{style:{width:"29.1%",fontSize:17,paddingLeft:15,display:"flex",alignItems:"center"}},"预约面额"),Y.map(function(t){return b.default.createElement(T,{key:t.value,defaultChecked:t.checked,style:{width:"29.1%"},onChange:function(){return e.selectMoneyType(t)}},t.value)})):null),b.default.createElement(p.default,{renderHeader:function(){return"预约受理时间: "+x.format("mm:ss")+" ~ "+O.format("mm:ss")}},b.default.createElement(f.default,h({mode:"date",onChange:this.handleDate},v,{value:i}),b.default.createElement(p.default.Item,{arrow:"horizontal"},"预约日期")),b.default.createElement(f.default,h({mode:"time",minuteStep:30},k,{onChange:this.handleTime,value:r}),b.default.createElement(p.default.Item,{arrow:"horizontal"},"预约时间")),b.default.createElement(c.default,{title:"备注",placeholder:"填写备注的信息，文字不得超过30字",autoHeight:!0,count:30,onChange:this.handleRemark})),b.default.createElement(u.default,{style:{marginTop:48,marginBottom:48}},b.default.createElement(l.default,{type:"primary",disabled:m,onClick:this.confirm},"提交预约申请")))}}]),t}(),a=function(){var e=this;this.getServiceList=function(){O.default.get("/api/v1/service/services").then(function(e){var t=e.data;M.default.origin_service_type_list=t,M.default.service_type_list=t.map(function(e){return{label:e.category,value:e.category}})}).catch(function(t){var n=t.data;if(n){if(10001===n.error_code||10001===n.errorCode){(0,z.getWxToken)().then(function(t){e.getServiceList()})}}else(0,z.getWxToken)().then(function(t){e.getServiceList()})})},this.getBankList=function(){O.default.get("/api/v1/banks").then(function(e){var t=e.data;M.default.bank_list=t.map(function(e){return{label:e.name+"("+e.address+")",value:e.id}})}).catch(function(t){var n=t.data;if(n){if(10001===n.error_code||10001===n.errorCode){(0,z.getWxToken)().then(function(t){e.getBankList()})}}else(0,z.getWxToken)().then(function(t){e.getBankList()})})},this.sexList=[{label:"男",value:"1"},{label:"女",value:"2"}],this.selectMoneyType=function(e){var t=Array.from(M.default.money_type_list);t.forEach(function(t){e.value===t.value&&(t.checked=!t.checked)}),M.default.money_type_list=t},this.pickSex=function(e){M.default.selectSex=e},this.pickBank=function(e){M.default.selected_bank=e},this.pickServiceType=function(e){M.default.service_type=e;var t=[],n=!1,i=!1;Array.from(M.default.origin_service_type_list).forEach(function(r){if(r.category===e[0]){1===r.money&&(n=!0),2===r.money_type&&(i=!0),t=r.item.map(function(e){return{label:e,value:e}});var a=r.time_begin||"08:00:00",o=r.time_end||"15:00";M.default.time_begin=(0,E.default)(a,"mm:ss:SS"),M.default.time_end=(0,E.default)(o,"mm:ss:SS"),M.default.minMaxDate=(0,x.getMinMaxDate)(M.default.time_begin,M.default.time_end)}}),M.default.service_content_list=t,M.default.service_content=[],M.default.showMoney=n,M.default.showMoneyType=i},this.pickServiceContent=function(e){M.default.service_content=e},this.handleDate=function(e){M.default.date=e},this.handleTime=function(e){M.default.time=e},this.handleRemark=function(e){M.default.remark=e},this.confirm=function(){var e=M.default.disableBtn,t=M.default.name,n=M.default.phone,i=M.default.identity,r=M.default.sex,a=M.default.service,u=M.default.service_item,l=M.default.bank_id,c=M.default.day,f=M.default.money,s=M.default.showMoney,d=M.default.name_sub,p=M.default.remark,m=M.default.showMoneyType,h=M.default.money_type_list;if(!e){var y={name:t,phone:n,identity:i,sex:r,service:a,service_item:u,bank_id:l,day:c,remark:p};if(s&&(y.money=f),d&&(y.name_sub=d),m){var v=Array.from(h).filter(function(e){return!!e.checked});y.denomination=v.map(function(e){return e.value}).join(",")}y.remark=p||"",o.default.loading("提交中，请稍后...",30),O.default.post("/api/v1/order/save",y).then(function(e){o.default.hide();var t=e.data;0!==t.error_code&&0!==t.errorCode||D.default.push("/appointment/result")}).catch(function(e){o.default.hide()})}}},i=r))||i;t.default=P},nE73:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return t.trim().split(/\s+/).map(function(t){return e[t]}).join(" ")}},qLGs:function(e,t,n){e.exports={header:"_2YR1Z9jstTfLS7Tdu9GRqj"}}}]);
//# sourceMappingURL=21_014dfb0596b0c2c6d6a8.js.map