{"version":3,"sources":["webpack:///./imgs/company.png","webpack:///./less/index.mobile.less?7849","webpack:///./stores/index_index.js","webpack:///./helpers/get_param.js","webpack:///./imgs/bank_book.png","webpack:///./imgs/e_bank.png","webpack:///./helpers/fresh_token.js","webpack:///./pages_mobile/index/index.js","webpack:///./imgs/bottom.png","webpack:///./helpers/multiple_class.js"],"names":["module","exports","__webpack_require__","p","index","grid-section","img","map-container","container","carousel-container","carousel-main","carousel-item","carousel-link","carousel-img","bank-list","bank-name","bank-address","bank-distance","_mobx","Store","observable","search","location","href","split","paramsObj","forEach","paramArr","length","key","value","decodeURIComponent","concat","promise","wxToken","notForce","code","state","pathname","history","removeParams","origin","encodeURIComponent","requestURL","window","appConfig","appId","Promise","resolve","reject","axios","get","params","then","res","catch","getWxToken","arguments","undefined","_get_param2","default","host","indexOf","refreshWxToken","_react","_mobxReact","_fresh_token","console","log","styles","Index","observer","props","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","getUserLocation","latLng","data","store","loadScript","setTimeout","newRes","newLatLng","initMap","locationFail","resData","error_code","errorCode","init","script","document","createElement","type","src","body","appendChild","that","latitude","longitude","mapContainer","getElementById","style","height","myLatlng","qq","maps","LatLng","myOptions","zoom","center","noClear","mapTypeId","MapTypeId","ROADMAP","draggable","scrollwheel","disableDoubleClickZoom","keyboardShortcuts","panControl","zoomControl","scaleControl","map","Map","markers","searchService","SearchService","complete","results","pois","detail","i","l","poi","marker","Marker","position","setTitle","push","getDistance","setPageCapacity","searchNearBy","from","latLngs","lat","lng","resDistance","join","distanceList","status","result","elements","bankItem","distance","sort","a","b","name","address","distance_list","getCarouselList","carousel_list","getIndexList","eBankList","bankBookList","companyList","item","index_type","e_bank_list","bank_book_list","company_list","showBankPanel","bool","e","preventDefault","stopPropagation","timer","open","index_list","Component","_this2","carouselList","Array","sidebar","_react2","_list2","className","_multiple_class2","Item","thumb","_wingBlank2","boxShadow","_carousel2","width","infinite","autoplay","carousel","url","logo","eBankImg","_grid2","columnNum","square","renderItem","dataItem","bankBookImg","companyImg","onClick","id","bottomImg","_drawer2","onOpenChange","minHeight","documentElement","clientHeight","zIndex","contentStyle","color","textAlign","paddingTop","sidebarStyle","border","styleObj","classStr","trim"],"mappings":"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","file":"scripts/18_d5a051a40c86e85649db.js","sourcesContent":["module.exports = __webpack_public_path__ + \"imgs/company6e3dfc8501bb0c5b6ab718fb42d50157.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"index\":\"NBTPEOnHPEEn5tPSF1w_c\",\"grid-section\":\"_2HIMQYkQoRe0NzHL-mjblU\",\"img\":\"_7B8iEwl_segTVQfEhQLSk\",\"map-container\":\"_2L8er1C0yOPM8g0-BTddMK\",\"container\":\"_3iqK_pGAevt3KY9CayYakZ\",\"carousel-container\":\"KoRmnDa0dCGgn6t6nCYk_\",\"carousel-main\":\"_1fkk4NK8BySiiyARYJzlar\",\"carousel-item\":\"_2M-T7fowKiEmVHwb9RxY1K\",\"carousel-link\":\"_3UNsHO3FgRA6YWneRCve7l\",\"carousel-img\":\"A9wf6tovXyIPH8doLZmcA\",\"bank-list\":\"_3QrrWBSqvOIpG3QsU84d6z\",\"bank-name\":\"_1PV_LQDKPsrxc6fIfBHzyT\",\"bank-address\":\"_2x5jiO4fbub9SNmV8Oqbtl\",\"bank-distance\":\"_3H-rYFGIZ-s25fck_5I7HW\"};","import { observable } from 'mobx';\r\nclass Store {\r\n\t@observable index_list = [];\r\n\t@observable e_bank_list = [];//电子银行业务\r\n\t@observable bank_book_list = [];//银行预约业务\r\n\t@observable company_list = [];//公司业务\r\n\t@observable carousel_list = [];\r\n\t@observable distance_list = [];\r\n\t@observable pois = [];\r\n\t@observable open = false;\r\n\t@observable latLng;\r\n\t@observable locationFail = false;\r\n}\r\nexport default new Store();","let getParam = () => {\r\n\tlet search = location.href.split('?')[1];\r\n\tif(search){\r\n\t\tsearch = search.split('#')[0];//去除hash的干扰\r\n\t\tlet paramsArr = search.split('&');\r\n\t\tlet paramsObj = {};\r\n\t\tparamsArr.forEach(p => {\r\n\t\t\tlet paramArr = p.split('=');\r\n\t\t\tif(paramArr.length === 2){\r\n\t\t\t\tlet key = paramArr[0];\r\n\t\t\t\tlet value = decodeURIComponent(paramArr[1]);\r\n\t\t\t\tif(paramsObj[key]){\r\n\t\t\t\t\tparamsObj[key] = [value].concat(paramsObj[key]);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tparamsObj[key] = value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn paramsObj;\r\n\t}\r\n\treturn {};\r\n};\r\nexport default getParam;","module.exports = __webpack_public_path__ + \"imgs/bank_book836a9949427176637e458b7d1e5134e3.png\";","module.exports = __webpack_public_path__ + \"imgs/e_bank42f6df46e2cd0aa8783c5cae9b6a74e9.png\";","import axios from 'axios';\r\nimport getParam from './get_param';\r\nimport history from '../history';\r\nlet promise = null;\r\n\r\nlet wxToken = (notForce, code, state) => {\r\n\tlet { location: {pathname} } = history;\r\n\tlet removeHash = location.href.split('#')[0];\r\n\tlet removeParams = removeHash.split('?')[0];\r\n\tlet origin = encodeURIComponent(removeParams + '#' + pathname);\r\n\tlet appId = window.appConfig.appId;\r\n\tlet requestURL = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${appId}&redirect_uri=${origin}&response_type=code&scope=snsapi_userinfo&state=${state}#wechat_redirect`;\r\n\t//notForce true,上传code供后端获取用户信息 false,强制重新获取code\r\n\tif(!notForce){\r\n\t\twindow.location = requestURL;\r\n\t}else{\r\n\t\tif(promise) return promise;\r\n\t\tpromise = new Promise((resolve, reject) =>{\r\n\t\t\taxios.get('/api/v1/token/user', {\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tcode\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tpromise = null;\r\n\t\t\t\t\tresolve(res);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(res => {\r\n\t\t\t\t\tpromise = null;\r\n\t\t\t\t\treject(res);\r\n\t\t\t\t})\r\n\t\t});\r\n\t\treturn promise;\r\n\t}\r\n};\r\n\r\nlet getWxToken = (state = '') => {\r\n\t//如果有code则上传\r\n\tlet code = getParam().code;\r\n\t// alert(code);\r\n\tif(location.host.indexOf('localhost') !== -1 || location.host.indexOf('127.0.0.1') !== -1) return new Promise((resolve, reject) => {\r\n\t\treject();\r\n\t});\r\n\treturn wxToken(!!code, code, state);\r\n};\r\nlet refreshWxToken = () => {\r\n\t//强制重新获取code\r\n\treturn wxToken(false);\r\n};\r\nexport {\r\n\tgetWxToken,\r\n\trefreshWxToken\r\n};","import React, { Component } from 'react';\r\nimport { WingBlank, Grid, Carousel, Drawer, List } from 'antd-mobile';\r\nimport styles from '../../less/index.mobile.less';\r\nimport multipleClass from '../../helpers/multiple_class';\r\nimport { observer } from 'mobx-react';\r\nimport store from '../../stores/index_index';\r\nimport axios from 'axios';\r\nimport { getWxToken } from '../../helpers/fresh_token';\r\nimport bottomImg from '../../imgs/bottom.png';\r\nimport eBankImg from '../../imgs/e_bank.png';\r\nimport bankBookImg from '../../imgs/bank_book.png';\r\nimport companyImg from '../../imgs/company.png';\r\nconsole.log(styles);\r\n@observer\r\nclass Index extends Component{\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tstore.carousel_list = [];//轮播图\r\n\t\tstore.index_list = [];//首页模块图\r\n\t\tstore.distance_list = [];\r\n\t\tstore.open = false;\r\n\t}\r\n\trender(){\r\n\t\tlet { locationFail, distance_list,carousel_list, open, e_bank_list, bank_book_list, company_list } = store;\r\n\t\tlet carouselList = Array.from(carousel_list);\r\n\t\tlet distanceList = Array.from(distance_list);\r\n\t\tconst eBankList = Array.from(e_bank_list),\r\n\t\t\tbankBookList = Array.from(bank_book_list),\r\n\t\t\tcompanyList = Array.from(company_list);\r\n\t\tconst sidebar = (<List className={multipleClass(styles, 'bank-list')}>\r\n\t\t\t{distanceList.map((distance, index) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<List.Item key={index} thumb={<span>{index + 1}</span>}>\r\n\t\t\t\t\t\t<h4 className={multipleClass(styles, 'bank-name')}>{distance.name}</h4>\r\n\t\t\t\t\t\t<p className={multipleClass(styles, 'bank-address')}>{distance.address}</p>\r\n\t\t\t\t\t\t<p className={multipleClass(styles, 'bank-distance')}>驾车距离: <span>约{distance.distance}公里</span></p>\r\n\t\t\t\t\t</List.Item>\r\n\t\t\t\t);\r\n\t\t\t})}\r\n\t\t</List>);\r\n\t\treturn (\r\n\t\t\t<div className={multipleClass(styles, 'index')}>\r\n\t\t\t\t<WingBlank style={{boxShadow: '0 2px 8px rgba(0,0,0,.09)', height: '100%'}}>\r\n\t\t\t\t\t<Carousel style={{width: '100%', height: '100%'}} infinite autoplay={true}>\r\n\t\t\t\t\t\t{carouselList.map((carousel, index) => (\r\n\t\t\t\t\t\t\t<a key={'carousel-' + index} href={carousel.url} className={multipleClass(styles, 'carousel-link')}>\r\n\t\t\t\t\t\t\t\t<img src={carousel.logo} className={multipleClass(styles, 'carousel-img')}/>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</Carousel>\r\n\t\t\t\t\t<section className={multipleClass(styles, 'grid-section')}>\r\n\t\t\t\t\t\t<h3>\r\n\t\t\t\t\t\t\t<img src={eBankImg} style={{width: '100%'}}/>\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\tcolumnNum={3}\r\n\t\t\t\t\t\t\tdata={eBankList}\r\n\t\t\t\t\t\t\tsquare={false}\r\n\t\t\t\t\t\t\trenderItem={dataItem => (\r\n\t\t\t\t\t\t\t\t<a href={dataItem.url}>\r\n\t\t\t\t\t\t\t\t\t<img src={dataItem.logo} style={{width: '100%'}}/>\r\n\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</section>\r\n\t\t\t\t\t<section className={multipleClass(styles, 'grid-section')}>\r\n\t\t\t\t\t\t<h3>\r\n\t\t\t\t\t\t\t<img src={bankBookImg} style={{width: '100%'}}/>\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\tcolumnNum={3}\r\n\t\t\t\t\t\t\tdata={bankBookList}\r\n\t\t\t\t\t\t\tsquare={false}\r\n\t\t\t\t\t\t\trenderItem={dataItem => (\r\n\t\t\t\t\t\t\t\t<a href={dataItem.url}>\r\n\t\t\t\t\t\t\t\t\t<img src={dataItem.logo} style={{width: '100%'}}/>\r\n\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</section>\r\n\t\t\t\t\t<section className={multipleClass(styles, 'grid-section')}>\r\n\t\t\t\t\t\t<h3>\r\n\t\t\t\t\t\t\t<img src={companyImg} style={{width: '100%'}}/>\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\tcolumnNum={3}\r\n\t\t\t\t\t\t\tdata={companyList}\r\n\t\t\t\t\t\t\tsquare={false}\r\n\t\t\t\t\t\t\trenderItem={dataItem => (\r\n\t\t\t\t\t\t\t\t<a href={dataItem.url}>\r\n\t\t\t\t\t\t\t\t\t<img src={dataItem.logo} style={{width: '100%'}}/>\r\n\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</section>\r\n\t\t\t\t\t<a className={multipleClass(styles,'map-container')} onClick={(e) => this.showBankPanel(true, e)}>\r\n\t\t\t\t\t\t<div style={{position: 'absolute', width: '100%', height: '100%'}}>\r\n\t\t\t\t\t\t\t<div id='container' className={multipleClass(styles, 'container')}>\r\n\t\t\t\t\t\t\t\t{locationFail ? <img src={bottomImg} style={{width: '100%'}}/> : null}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<Drawer\r\n\t\t\t\t\t\tonOpenChange={() => this.showBankPanel(!open)}\r\n\t\t\t\t\t\tstyle={{ minHeight: document.documentElement.clientHeight, zIndex: open ? 9999 : -1, position: 'fixed'}}\r\n\t\t\t\t\t\tcontentStyle={{ color: '#A6A6A6', textAlign: 'center', paddingTop: 42 }}\r\n\t\t\t\t\t\tsidebarStyle={{ border: '1px solid #ddd' }}\r\n\t\t\t\t\t\tsidebar={sidebar}\r\n\t\t\t\t\t\topen={open}\r\n\t\t\t\t\t\tposition='bottom'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</WingBlank>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\tcomponentDidMount(){\r\n\t\tthis.getCarouselList();\r\n\t\tthis.getIndexList();\r\n\t\tthis.getUserLocation();\r\n\t}\r\n\tgetUserLocation = () => {\r\n\t\taxios.get('/api/v1/location')\r\n\t\t\t.then(res => {\r\n\t\t\t\tlet latLng = res.data[0];\r\n\t\t\t\tstore.latLng = latLng;\r\n\t\t\t\tif(latLng){\r\n\t\t\t\t\tthis.loadScript();\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\taxios.get('/api/v1/location')\r\n\t\t\t\t\t\t\t.then(newRes => {\r\n\t\t\t\t\t\t\t\tlet newLatLng = newRes.data[0];\r\n\t\t\t\t\t\t\t\tstore.latLng = newLatLng;\r\n\t\t\t\t\t\t\t\tthis.initMap();\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t}, 5500);//5.5秒之后再次获取最新的地理位置。\r\n\t\t\t\t}else{\r\n\t\t\t\t\tstore.locationFail = true;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.then(res => {\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tif (!resData) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getUserLocation();\r\n\t\t\t\t\t})\r\n\t\t\t\t} else if (resData.error_code === 10001 || resData.errorCode === 10001) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getUserLocation();\r\n\t\t\t\t\t})\r\n\t\t\t\t}else{\r\n\t\t\t\t\tstore.locationFail = true;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t};\r\n\tloadScript = () => {\r\n\t\twindow.init = this.initMap;\r\n\t\tlet script = document.createElement(\"script\");\r\n\t\tscript.type = \"text/javascript\";\r\n\t\tscript.src = \"http://map.qq.com/api/js?v=2.exp&callback=init\";\r\n\t\tdocument.body.appendChild(script);\r\n\t};\r\n\tinitMap = () => {\r\n\t\tlet that = this;\r\n\t\tlet { latLng } = store;\r\n\t\tlet { latitude, longitude } = latLng;\r\n\t\tlet mapContainer = document.getElementById('container');\r\n\t\tmapContainer.style.height = '220px';\r\n\t\tlet myLatlng = new qq.maps.LatLng(latitude, longitude);\r\n\t\tlet myOptions = {\r\n\t\t\tzoom: 13,\r\n\t\t\tcenter: myLatlng,\r\n\t\t\t//如果为 true，在初始化地图时不会清除地图容器内的内容\r\n\t\t\tnoClear: true,\r\n\t\t\tmapTypeId: qq.maps.MapTypeId.ROADMAP,\r\n\t\t\t//若为false则禁止拖拽\r\n\t\t\tdraggable: false,\r\n\t\t\t//若为false则禁止滑轮滚动缩放\r\n\t\t\tscrollwheel: false,\r\n\t\t\t//若为true则禁止双击放大\r\n\t\t\tdisableDoubleClickZoom: true,\r\n\t\t\t//若为false则禁止键盘控制地图\r\n\t\t\tkeyboardShortcuts: false,\r\n\t\t\t//地图平移控件，若为false则不显示平移控件\r\n\t\t\tpanControl: false,\r\n\t\t\t//地图缩放控件，若为false则不显示缩放控件\r\n\t\t\tzoomControl: false,\r\n\r\n\t\t\t//地图比例尺控件，若为false则不显示比例尺控件\r\n\t\t\tscaleControl: false,\r\n\t\t};\r\n\t\tlet map = new qq.maps.Map(mapContainer, myOptions);\r\n\t\tlet markers = [];\r\n\t\t//调用Poi检索类\r\n\t\tlet searchService = new qq.maps.SearchService({\r\n\t\t\tcomplete : function(results){\r\n\t\t\t\tlet pois = results.detail.pois;\r\n\t\t\t\tstore.pois = pois;\r\n\t\t\t\tfor(let i = 0,l = pois.length;i < l; i++){\r\n\t\t\t\t\tlet poi = pois[i];\r\n\t\t\t\t\tlet marker = new qq.maps.Marker({\r\n\t\t\t\t\t\tmap: map,\r\n\t\t\t\t\t\tposition: poi.latLng\r\n\t\t\t\t\t});\r\n\t\t\t\t\tmarker.setTitle(i+1);\r\n\t\t\t\t\tmarkers.push(marker);\r\n\t\t\t\t}\r\n\t\t\t\tthat.getDistance(latitude+',' + longitude, pois);\r\n\t\t\t}\r\n\t\t});\r\n\t\tsearchService.setPageCapacity(20);\r\n\t\tsearchService.searchNearBy('农商行', myLatlng, 2000);\r\n\t};\r\n\tgetDistance = (from, pois) => {\r\n\t\t//单起点到多终点\r\n\t\tlet latLngs = pois.map(poi => {\r\n\t\t\treturn poi.latLng.lat + ',' + poi.latLng.lng;\r\n\t\t});\r\n\t\twindow.resDistance = this.resDistance;\r\n\t\tlet script = document.createElement('script');\r\n\t\t//默认以开车的方式\r\n\t\tscript.src = `http://apis.map.qq.com/ws/distance/v1/?from=${from}&to=${latLngs.join(';')}&key=GW2BZ-TQNE6-KTASK-E7CO3-22Z37-6IBXA&output=jsonp&callback=resDistance`;\r\n\t\tdocument.body.appendChild(script);\r\n\t};\r\n\tresDistance = (res) => {\r\n\t\tlet distanceList = [];\r\n\t\tlet { pois } = store;\r\n\t\tif(res.status === 0){\r\n\t\t\tlet results = res.result.elements;\r\n\t\t\tlet mergeResults = results.map((result, index) => {\r\n\t\t\t\tlet poi = pois[index];\r\n\t\t\t\tlet bankItem = {\r\n\t\t\t\t\t...poi,\r\n\t\t\t\t\t...result\r\n\t\t\t\t};\r\n\t\t\t\tbankItem.distance = bankItem.distance/1000;\r\n\t\t\t\treturn bankItem;\r\n\t\t\t});\r\n\t\t\tdistanceList = mergeResults.sort((a, b) => {//排序\r\n\t\t\t\treturn a.distance - b.distance;\r\n\t\t\t});\r\n\t\t}else{\r\n\t\t\tdistanceList.push({\r\n\t\t\t\tname: '获取银行位置失败',\r\n\t\t\t\taddress: '-',\r\n\t\t\t\tdistance: 0\r\n\t\t\t});\r\n\t\t}\r\n\t\tstore.distance_list = distanceList;\r\n\t};\r\n\t//获取轮播图\r\n\tgetCarouselList = () => {\r\n\t\taxios.get('/api/v1/wx/navs', {\r\n\t\t\tparams: {\r\n\t\t\t\ttype: 1\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then(res => {\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tstore.carousel_list = resData;\r\n\t\t\t})\r\n\t\t\t.catch(res => {\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tif (!resData) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getCarouselList();\r\n\t\t\t\t\t})\r\n\t\t\t\t} else if (resData.error_code === 10001 || resData.errorCode === 10001) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getCarouselList();\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t};\r\n\t//获取首页模块图\r\n\tgetIndexList = () => {\r\n\t\taxios.get('/api/v1/wx/navs', {\r\n\t\t\tparams: {\r\n\t\t\t\ttype: 2\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then(res => {\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tlet eBankList = [],\r\n\t\t\t\t\tbankBookList = [],\r\n\t\t\t\t\tcompanyList = [];\r\n\t\t\t\tresData.forEach(item => {\r\n\t\t\t\t\tif(item.index_type === 1){\r\n\t\t\t\t\t\teBankList.push(item);\r\n\t\t\t\t\t}else if(item.index_type === 2){\r\n\t\t\t\t\t\tbankBookList.push(item);\r\n\t\t\t\t\t}else if(item.index_type === 3){\r\n\t\t\t\t\t\tcompanyList.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tstore.e_bank_list = eBankList;\r\n\t\t\t\tstore.bank_book_list = bankBookList;\r\n\t\t\t\tstore.company_list = companyList;\r\n\t\t\t\t// store.index_list = resData;\r\n\t\t\t})\r\n\t\t\t.catch(res => {\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tif (!resData) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getIndexList();\r\n\t\t\t\t\t})\r\n\t\t\t\t} else if (resData.error_code === 10001 || resData.errorCode === 10001) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getIndexList();\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t};\r\n\tshowBankPanel = (bool, e) => {\r\n\t\tif(e){\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t}\r\n\t\tif(this.timer) return;\r\n\t\tthis.timer = setTimeout(() => {\r\n\t\t\tstore.open = bool;\r\n\t\t\tthis.timer = null;\r\n\t\t}, 100);\r\n\t}\r\n}\r\nexport default Index;","module.exports = __webpack_public_path__ + \"imgs/bottom6cd0304d503972cc08f891921e751056.png\";","let multipleClass = (styleObj, classStr) => {\r\n\treturn classStr.trim().split(/\\s+/).map(key => styleObj[key]).join(' ');\r\n};\r\nexport default multipleClass;"],"sourceRoot":""}