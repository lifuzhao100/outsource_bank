{"version":3,"sources":["webpack:///./helpers/have_error.js","webpack:///./less/login.less?bdc5","webpack:///./pages_pc/login.js"],"names":["err","Object","keys","some","key","module","exports","login-container","flex","flex-middle","login","inline-flex","login-title","login-form","login-form-title","form-item","_react","__webpack_require__","Login","isPhoneTOuched","isPasswdTouched","state","loginSuccess","doLogin","that","_this$props$form","_this","props","form","getFieldsValue","setFields","values","phone","passwd","axios","post","then","res","data","sessionStorage","setItem","history","push","catch","error_code","response","value","errors","Error","Component","this","getFieldDecorator","getFieldsError","getFieldError","isFieldTouched","phoneErr","passwdErr","btnErr","_have_error2","default","_react2","createElement","className","_multiple_class2","styles","_form2","Item","help","validateStatus","rules","required","message","_input2","size","placeholder","autoComplete","type","_button2","disabled","style","width","onClick","validateFields","create"],"mappings":"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","file":"scripts/16_70017c8333de0440d702.js","sourcesContent":["let haveError = (err) => {\r\n\treturn Object.keys(err).some(key => err[key]);\r\n};\r\nexport default haveError;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"login-container\":\"_3PtYaz55lWdILoCY8af19R\",\"flex\":\"_3SqBKymT7aoDyHy1Nzlrdo\",\"flex-middle\":\"_1pPoawMSgJFdE4rWeNcAHo\",\"login\":\"fXMBBTmbijDj64F4pX9Vk\",\"inline-flex\":\"Cvve8I2QCaUNLwWIpIGmh\",\"login-title\":\"_3SZ33zAntY2HdmTmHhAF\",\"login-form\":\"gLnCltmN6Bp6RiSsFCia3\",\"login-form-title\":\"_1JAj4TZFWqH0AouSfq7HDq\",\"form-item\":\"hI0xlvLudLyQUPCxVJNTx\"};","import React, { Component } from 'react';\r\nimport styles from '../less/login.less';\r\nimport multipleClass from '../helpers/multiple_class';\r\nimport { Form, Input, Button } from 'antd';\r\nimport haveError from '../helpers/have_error';\r\nimport axios from 'axios';\r\nimport history from '../history';\r\nclass Login extends Component{\r\n\tisPhoneTOuched = false;\r\n\tisPasswdTouched = false;\r\n\tstate = {\r\n\t\tloginSuccess: false\r\n\t};\r\n\trender(){\r\n\t\tlet { form } = this.props;\r\n\t\tlet { loginSuccess } = this.state;\r\n\t\tlet { getFieldDecorator, getFieldsError, getFieldError, isFieldTouched } = form;\r\n\t\tif(isFieldTouched('phone')){\r\n\t\t\tthis.isPhoneTOuched = true;\r\n\t\t}\r\n\t\tif(isFieldTouched('passwd')){\r\n\t\t\tthis.isPasswdTouched = true;\r\n\t\t}\r\n\t\t//由于会出现isFieldTouched刷新的情况，暂时使用这种方式来保存isFieldTouched的状态\r\n\t\tlet phoneErr;\r\n\t\tlet passwdErr;\r\n\t\tif(this.isPhoneTOuched){\r\n\t\t\tphoneErr = getFieldError('phone');\r\n\t\t}\r\n\t\tif(this.isPasswdTouched){\r\n\t\t\tpasswdErr = getFieldError('passwd');\r\n\t\t}\r\n\t\tlet btnErr = haveError(getFieldsError());\r\n\t\treturn (\r\n\t\t\t<div className={multipleClass(styles, 'login-container flex flex-middle')}>\r\n\t\t\t\t<div className={multipleClass(styles, 'login flex')}>\r\n\t\t\t\t\t<h3 className={multipleClass(styles, 'login-title inline-flex flex-middle')}>预约管理</h3>\r\n\t\t\t\t\t<div className={multipleClass(styles, 'login-form flex flex-middle')}>\r\n\t\t\t\t\t\t<h4 className={multipleClass(styles, 'login-form-title')}>请登陆</h4>\r\n\t\t\t\t\t\t<Form >\r\n\t\t\t\t\t\t\t<Form.Item\r\n\t\t\t\t\t\t\t\thelp={phoneErr ? phoneErr : ''}\r\n\t\t\t\t\t\t\t\tvalidateStatus={phoneErr ? 'error': 'success'}\r\n\t\t\t\t\t\t\t\tclassName={multipleClass(styles, 'form-item')}>{getFieldDecorator('phone', {\r\n\t\t\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\t\t\tmessage: '请输入账号'\r\n\t\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t\t})(\r\n\t\t\t\t\t\t\t\t<Input size='large' placeholder='账号' autoComplete='off'/>\r\n\t\t\t\t\t\t\t)}</Form.Item>\r\n\t\t\t\t\t\t\t<Form.Item\r\n\t\t\t\t\t\t\t\thelp={passwdErr ? passwdErr : ''}\r\n\t\t\t\t\t\t\t\tvalidateStatus={passwdErr ? 'error': 'success'}\r\n\t\t\t\t\t\t\t\tclassName={multipleClass(styles, 'form-item')}>{getFieldDecorator('passwd', {\r\n\t\t\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\t\t\tmessage: '请输入密码'\r\n\t\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t\t})(\r\n\t\t\t\t\t\t\t\t<Input type='password' size='large' placeholder='密码' autoComplete='off'/>\r\n\t\t\t\t\t\t\t)}</Form.Item>\r\n\t\t\t\t\t\t\t<Form.Item className={multipleClass(styles, 'form-item')}>\r\n\t\t\t\t\t\t\t\t<Button disabled={btnErr} size='large' style={{width: '100%'}} type='primary' onClick={this.doLogin}>登陆</Button>\r\n\t\t\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\tcomponentDidMount(){\r\n\t\tthis.props.form.validateFields();\r\n\t}\r\n\tdoLogin = () => {\r\n\t\tlet that = this;\r\n\t\tlet { getFieldsValue, setFields } = this.props.form;\r\n\t\tlet values = getFieldsValue();\r\n\t\tif(!values.phone || !values.passwd) return;\r\n\t\taxios.post('/api/v1/token/admin', values)\r\n\t\t\t.then(res => {\r\n\t\t\t\tlet { data } = res;\r\n\t\t\t\tsessionStorage.setItem('token', data['token']);\r\n\t\t\t\tsessionStorage.setItem('username', data['username']);\r\n\t\t\t\tsessionStorage.setItem('u_id', data['u_id']);\r\n\t\t\t\tsessionStorage.setItem('phone', values.phone);\r\n\t\t\t\thistory.push('/appointment/index');\r\n\t\t\t}).catch(res => {\r\n\t\t\t\tlet { response: {data: {error_code}} } = res;\r\n\t\t\t\tif(error_code === 30000){\r\n\t\t\t\t\tsetFields({\r\n\t\t\t\t\t\tphone: {\r\n\t\t\t\t\t\t\tvalue: values.phone,\r\n\t\t\t\t\t\t\terrors: [\r\n\t\t\t\t\t\t\t\tnew Error('用户不存在')\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}else if(error_code === 30002){\r\n\t\t\t\t\tthat.props.form.setFields({\r\n\t\t\t\t\t\tpasswd: {\r\n\t\t\t\t\t\t\tvalue: values.passwd,\r\n\t\t\t\t\t\t\terrors: [\r\n\t\t\t\t\t\t\t\tnew Error('密码不正确')\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\nexport default Form.create()(Login);"],"sourceRoot":""}