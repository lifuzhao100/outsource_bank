{"version":3,"sources":["webpack:///./stores/appointment_list.js","webpack:///./helpers/get_param.js","webpack:///./pages_mobile/appointment/list.js","webpack:///./config/CONSTANT.js","webpack:///./helpers/fresh_token.js","webpack:///./helpers/multiple_class.js","webpack:///./less/appointment_list.less?108f"],"names":["_mobx","__webpack_require__","_moment","Store","_moment2","default","this","date","format","observable","toDate","computed","search","location","href","split","paramsObj","forEach","p","paramArr","length","key","value","concat","_react","_mobxReact","_CONSTANT","_fresh_token","moment","locale","AppointmentList","observer","props","_classCallCheck","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","getAppointmentList","page","arguments","undefined","day","store","grade","params","size","SIZE","axios","get","then","res","loading","resData","data","appointmentList","Array","from","appointment_list","concatResult","user_grade","orders","user_type","total","dataSource","cloneWithRows","catch","error_code","errorCode","getWxToken","reject","id","_modal2","alert","text","onPress","handleAppointment","resolve","cancel","loadMore","state","post","a","goIndex","history","push","openDateModal","visible","closeDateModal","setDate","_listView2","DataSource","rowHasChanged","row1","row2","param","_get_param2","Date","Component","_this2","_react2","createElement","className","_multiple_class2","styles","_button2","inline","onClick","_list2","style","borderBottom","Item","_datePicker2","mode","onDismiss","onOk","renderSectionHeader","renderRow","rowData","sectionID","rowID","_ref","btns","parseInt","type","disabled","padding","display","_defineProperty","height","marginRight","src","headimgurl","alt","lineHeight","flexGrow","flexShrink","marginBottom","fontWeight","name","address","sex","MALE","service","service_item","money","renderSeparator","margin","renderFooter","textAlign","pageSize","useBodyScroll","onEndReached","FEMALE","promise","wxToken","notForce","code","pathname","removeParams","requestURL","encodeURIComponent","Promise","window","refreshWxToken","styleObj","classStr","trim","map","join","module","exports","home","btn-group"],"mappings":"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","file":"scripts/19_36eb7abe8780a97dc386.js","sourcesContent":["import { observable, computed } from 'mobx';\r\nimport moment from 'moment';\r\nclass Store {\r\n\t@observable date = moment().toDate();\r\n\t@observable grade;\r\n\t@observable visible = false;\r\n\t@observable appointment_list = [];\r\n\t@observable dataSource ;\r\n\t@observable user_type;\r\n\t@observable loading = false;\r\n\t@computed get day(){\r\n\t\treturn moment(this.date).format('YYYY-MM-DD');\r\n\t}\r\n}\r\nexport default new Store();","let getParam = () => {\r\n\tlet search = location.href.split('?')[1];\r\n\tif(search){\r\n\t\tsearch = search.split('#')[0];//去除hash的干扰\r\n\t\tlet paramsArr = search.split('&');\r\n\t\tlet paramsObj = {};\r\n\t\tparamsArr.forEach(p => {\r\n\t\t\tlet paramArr = p.split('=');\r\n\t\t\tif(paramArr.length === 2){\r\n\t\t\t\tlet key = paramArr[0];\r\n\t\t\t\tlet value = paramArr[1];\r\n\t\t\t\tif(paramsObj[key]){\r\n\t\t\t\t\tparamsObj[key] = [value].concat(paramsObj[key]);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tparamsObj[key] = value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn paramsObj;\r\n\t}\r\n\treturn {};\r\n};\r\nexport default getParam;","import React, { Component } from 'react';\r\nimport { Button, List, DatePicker, ListView, Modal } from 'antd-mobile';\r\nimport multipleClass from '../../helpers/multiple_class';\r\nimport styles from '../../less/appointment_list.less';\r\nimport { observer } from 'mobx-react';\r\nimport store from '../../stores/appointment_list';\r\nimport moment from 'moment';\r\nmoment.locale('zh_cn');\r\nimport axios from 'axios';\r\nimport { SIZE, MALE, FEMALE} from \"../../config/CONSTANT\";\r\nimport getParam from \"../../helpers/get_param\";\r\nimport { getWxToken } from \"../../helpers/fresh_token\";\r\n@observer\r\nclass AppointmentList extends Component{\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tstore.dataSource = new ListView.DataSource({\r\n\t\t\trowHasChanged: (row1, row2) => row1 !== row2,\r\n\t\t});\r\n\t\tstore.appointment_list = [];\r\n\t\tlet param = getParam();\r\n\t\tif(param.day){\r\n\t\t\tstore.date = new Date(param.day);\r\n\t\t}\r\n\t\tif(param.grade){\r\n\t\t\tstore.grade = param.grade;\r\n\t\t}else{\r\n\t\t\tstore.grade = '';\r\n\t\t}\r\n\t\tthis.page = 1;\r\n\t}\r\n\trender(){\r\n\t\tlet { date, visible, dataSource, user_type, loading } = store;\r\n\t\tconst separator = (sectionID, rowID) => (\r\n\t\t\t<div\r\n\t\t\t\tkey={`${sectionID}-${rowID}`}\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tmargin: '0 15px',\r\n\t\t\t\t\tborderBottom: '1px solid #ECECED',\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t);\r\n\t\tconst row = (rowData, sectionID, rowID) => {\r\n\t\t\tlet btns = [];\r\n\t\t\tswitch (parseInt(rowData.state)){\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tif(user_type === 'admin'){\r\n\t\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t\t<Button inline={true} size='small' type='warning' onClick={() => this.reject(rowData.id)}>拒绝</Button>,\r\n\t\t\t\t\t\t\t<Button inline={true} size='small' type='primary' onClick={() => this.resolve(rowData.id)}>受理</Button>\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t\t<Button inline={true} size='small' type='warning' onClick={() => this.cancel(rowData.id)}>取消</Button>\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t<Button inline={true} size='small' type='primary' disabled={true}>已受理</Button>\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t<Button inline={true} size='small' type='warning' disabled={true}>已受理</Button>\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tbtns = [\r\n\t\t\t\t\t\t<Button inline={true} size='small' type='ghost' disabled={true} >已取消</Button>\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<div key={rowID} style={{ padding: '0 15px' }}>\r\n\t\t\t\t\t<div style={{ display: '-webkit-box', display: 'flex', padding: '15px 0' }}>\r\n\t\t\t\t\t\t<img style={{ height: '64px', marginRight: '15px' }} src={rowData.headimgurl} alt=\"\" />\r\n\t\t\t\t\t\t<div style={{ lineHeight: 1, flexGrow: 1, flexShrink: 1 }}>\r\n\t\t\t\t\t\t\t<div style={{ marginBottom: '8px', fontWeight: 'bold' }}>{rowData.name}</div>\r\n\t\t\t\t\t\t\t<p>{rowData.address}, {rowData.sex === MALE ? '男' : '女'}</p>\r\n\t\t\t\t\t\t\t<p>{rowData.service + '/' +rowData.service_item}{rowData.money > 0 ? '/' + rowData.money : ''}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className={multipleClass(styles, 'btn-group')}>{btns}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t};\r\n\t\treturn (\r\n\t\t\t<div className='appointment_list'>\r\n\t\t\t\t<div className={multipleClass(styles, 'home')}>\r\n\t\t\t\t\t<Button inline={true} size='small' onClick={this.goIndex}>首页</Button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<List style={{borderBottom:'none'}}>\r\n\t\t\t\t\t<List.Item\r\n\t\t\t\t\t\tonClick={this.openDateModal}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span>预约日期</span>\r\n\t\t\t\t\t\t<span className={multipleClass(styles, 'date')}>{moment(date).format('YYYY/MM/DD dddd')}</span>\r\n\t\t\t\t\t</List.Item>\r\n\t\t\t\t</List>\r\n\t\t\t\t<DatePicker\r\n\t\t\t\t\tvisible={visible}\r\n\t\t\t\t\tmode='date'\r\n\t\t\t\t\tonDismiss={this.closeDateModal}\r\n\t\t\t\t\tonOk={this.setDate}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListView\r\n\t\t\t\t\tdataSource={dataSource}\r\n\t\t\t\t\trenderSectionHeader={() => <span>预约列表</span>}\r\n\t\t\t\t\trenderRow={row}\r\n\t\t\t\t\trenderSeparator={separator}\r\n\t\t\t\t\trenderFooter={() => (<div style={{ padding: 30, textAlign: 'center' }}>\r\n\t\t\t\t\t\t{loading ? 'Loading...' : 'Loaded'}\r\n\t\t\t\t\t</div>)}\r\n\t\t\t\t\tpageSize={4}\r\n\t\t\t\t\tuseBodyScroll\r\n\t\t\t\t\tonEndReached={this.loadMore}\r\n\t\t\t\t>\r\n\t\t\t\t</ListView>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\tcomponentDidMount(){\r\n\t\tthis.getAppointmentList(this.page);\r\n\t}\r\n\tgetAppointmentList = (page = 1) => {\r\n\t\tlet { day, grade } = store;\r\n\t\tif(page === 1){\r\n\t\t\tthis.page = 1;//初始化\r\n\t\t}\r\n\t\tlet params = {\r\n\t\t\tpage,\r\n\t\t\tsize: SIZE,\r\n\t\t\tday: day\r\n\t\t};\r\n\t\tif(grade){\r\n\t\t\tparams.grade = grade;\r\n\t\t}\r\n\t\taxios.get('/api/v1/orders/wx', {\r\n\t\t\tparams: params\r\n\t\t})\r\n\t\t\t.then(res => {\r\n\t\t\t\tstore.loading = false;\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tlet appointmentList = Array.from(store.appointment_list);\r\n\t\t\t\tif(page === 1){//第一页重新渲染\r\n\t\t\t\t\tappointmentList = [];\r\n\t\t\t\t}\r\n\t\t\t\tlet concatResult;\r\n\t\t\t\tif(resData.user_grade == 1){//用户\r\n\t\t\t\t\tconcatResult = appointmentList.concat(resData.orders);\r\n\t\t\t\t\tstore.user_type = 'user';\r\n\t\t\t\t}else{//管理员\r\n\t\t\t\t\tconcatResult = appointmentList.concat(resData.data);\r\n\t\t\t\t\tstore.total = resData.total;\r\n\t\t\t\t\tstore.user_type = 'admin';\r\n\t\t\t\t}\r\n\t\t\t\tstore.appointment_list = concatResult;\r\n\t\t\t\tstore.dataSource = store.dataSource.cloneWithRows(concatResult);\r\n\t\t\t})\r\n\t\t\t.catch(res => {\r\n\t\t\t\tstore.loading = false;\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tif (!resData) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getAppointmentList();\r\n\t\t\t\t\t})\r\n\t\t\t\t} else if (resData.error_code === 10001 || resData.errorCode === 10001) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\tthis.getAppointmentList();\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t};\r\n\treject = (id) => {\r\n\t\tModal.alert('拒绝受理', '将拒绝受理此项业务，请确认',[\r\n\t\t\t{\r\n\t\t\t\ttext: '取消'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: '确认',\r\n\t\t\t\tonPress: () => this.handleAppointment(id, 3)\r\n\t\t\t}\r\n\t\t])\r\n\t};\r\n\tresolve = (id) => {\r\n\t\tModal.alert('受理', '将受理此项业务，请确认',[\r\n\t\t\t{\r\n\t\t\t\ttext: '取消'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: '确认',\r\n\t\t\t\tonPress: () => this.handleAppointment(id, 2)\r\n\t\t\t}\r\n\t\t])\r\n\t};\r\n\tcancel = id => {\r\n\t\tModal.alert('取消预约', '将取消预约此项业务，请确认',[\r\n\t\t\t{\r\n\t\t\t\ttext: '取消'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: '确认',\r\n\t\t\t\tonPress: () => this.handleAppointment(id, 4)\r\n\t\t\t}\r\n\t\t])\r\n\t};\r\n\tloadMore = () => {\r\n\t\tstore.loading = true;\r\n\t\tthis.getAppointmentList(++this.page);\r\n\t};\r\n\thandleAppointment = (id, state) => {\r\n\t\taxios.post('/api/v1/order/handel', {\r\n\t\t\tid: id,\r\n\t\t\tstate\r\n\t\t})\r\n\t\t\t.then(res => {\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tif(resData.error_code === 0 || resData.errorCode === 0){\r\n\t\t\t\t\tlet appointmentList = Array.from(store.appointment_list);\r\n\t\t\t\t\tappointmentList.forEach(a => {\r\n\t\t\t\t\t\tif(a.id === id){\r\n\t\t\t\t\t\t\ta.state = state;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tstore.appointment_list = appointmentList;\r\n\t\t\t\t\tstore.dataSource = store.dataSource.cloneWithRows(appointmentList);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(res => {\r\n\t\t\t\tlet resData = res.data;\r\n\t\t\t\tif (!resData) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\t//this.getUserLocation();\r\n\t\t\t\t\t})\r\n\t\t\t\t} else if (resData.error_code === 10001 || resData.errorCode === 10001) {\r\n\t\t\t\t\tlet promise = getWxToken();\r\n\t\t\t\t\tpromise.then(res => {\r\n\t\t\t\t\t\t//this.getUserLocation();\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t};\r\n\tgoIndex = () => {\r\n\t\tthis.props.history.push('/');\r\n\t};\r\n\topenDateModal = () => {\r\n\t\tstore.visible = true;\r\n\t};\r\n\tcloseDateModal = () => {\r\n\t\tstore.visible = false;\r\n\t};\r\n\tsetDate = (date) => {\r\n\t\tstore.date = date;\r\n\t\tstore.visible = false;\r\n\t\tthis.getAppointmentList();\r\n\t}\r\n}\r\nexport default AppointmentList;","const SIZE = 15;\r\nconst MALE = 1,\r\n\tFEMALE = 2;\r\n\r\n// const\r\nexport {\r\n\tSIZE,\r\n\tMALE,\r\n\tFEMALE\r\n};","import axios from 'axios';\r\nimport getParam from './get_param';\r\nimport history from '../history';\r\nlet promise = null;\r\n\r\nlet wxToken = (notForce, code) => {\r\n\tlet { location: {pathname} } = history;\r\n\tlet removeHash = location.href.split('#')[0];\r\n\tlet removeParams = removeHash.split('?')[0];\r\n\tlet origin = encodeURIComponent(removeParams + '#' + pathname);\r\n\tlet appid = 'wxf4b7d664b2461f4b';\r\n\tlet requestURL = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${appid}&redirect_uri=${origin}&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect;`\r\n\t//notForce true,上传code供后端获取用户信息 false,强制重新获取code\r\n\tif(!notForce){\r\n\t\twindow.location = requestURL;\r\n\t}else{\r\n\t\tif(promise) return promise;\r\n\t\tpromise = new Promise((resolve, reject) =>{\r\n\t\t\taxios.get('/api/v1/token/user', {\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tcode\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tpromise = null;\r\n\t\t\t\t\tresolve(res);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(res => {\r\n\t\t\t\t\tpromise = null;\r\n\t\t\t\t\treject(res);\r\n\t\t\t\t})\r\n\t\t});\r\n\t\treturn promise;\r\n\t}\r\n};\r\n\r\nlet getWxToken = () => {\r\n\t//如果有code则上传\r\n\tlet code = getParam().code;\r\n\treturn wxToken(!!code, code);\r\n};\r\nlet refreshWxToken = () => {\r\n\t//强制重新获取code\r\n\treturn wxToken(false);\r\n};\r\nexport {\r\n\tgetWxToken,\r\n\trefreshWxToken\r\n};","let multipleClass = (styleObj, classStr) => {\r\n\treturn classStr.trim().split(/\\s+/).map(key => styleObj[key]).join(' ');\r\n};\r\nexport default multipleClass;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"home\":\"_2sfP_co4kRvgphaC1NMPV2\",\"date\":\"_3fLReK9Q-jcWfZk702_V5Z\",\"btn-group\":\"xgFttKZnF3OHJtqAx5OvH\"};"],"sourceRoot":""}